################################################################################
# SafeNest Mosquitto ACL (Access Control List) Configuration
#
# This file defines which users can publish/subscribe to which topics.
# Format:
#   user <username>
#   topic [read|write|readwrite] <topic>
#
# Wildcards: + (single level), # (multi-level)
# Location: /etc/mosquitto/aclfile.conf
################################################################################

# === ADMIN/SECURITY USER ===
# Full access for the security detection engine
user security_user
topic readwrite #

# === PANEL USER (Home Control Panel) ===
# Can control all devices and receive all alerts
user panel_user

# Subscribe to all device states
topic read safenest/motion/state
topic read safenest/intercom/event
topic read safenest/light1/state
topic read safenest/light2/state

# Publish commands to control lights
topic write safenest/light1/set
topic write safenest/light2/set

# Subscribe to all alerts
topic read safenest/alerts/#

# === INTERCOM USER ===
# Can only publish intercom events
user intercom_user
topic write safenest/intercom/event
topic read safenest/intercom/commands

# === MOTION SENSOR USER ===
# Can only publish motion state
user motion_user
topic write safenest/motion/state

# === LIGHT USERS ===
# Light 1 - can publish state and receive commands
user light1_user
topic write safenest/light1/state
topic read safenest/light1/set

# Light 2 - can publish state and receive commands
user light2_user
topic write safenest/light2/state
topic read safenest/light2/set

# === NODE-RED DASHBOARD USER ===
# Read-only access to states and alerts, write access to control topics
user nodered_user

# Read all device states
topic read safenest/motion/state
topic read safenest/intercom/event
topic read safenest/light1/state
topic read safenest/light2/state
topic read safenest/alerts/#

# Write commands to lights
topic write safenest/light1/set
topic write safenest/light2/set

# === CONTROLLER USER ===
# The main SafeNest controller needs broad access
user controller_user
topic readwrite safenest/#

# === DENY ALL BY DEFAULT ===
# Any topics not explicitly allowed above are denied
